# E1-S1: Complete DevLogTimeline Component

## Story
**As a** developer monitoring multiple Claude Code sessions
**I want** a timeline view of session summaries showing what each session accomplished
**So that** I can review past work, see which files were changed, and understand tool usage patterns across sessions

## Status
- **Epic**: Core Dashboard Foundation
- **Priority**: P0-Critical
- **Points**: 5
- **Sprint**: 1
- **Dependencies**: E1-S2 (needs Project, Session, DevLog types in client)

## Acceptance Criteria
- [ ] AC1: DevLogTimeline renders a scrollable list of DevLog entries sorted by `ended_at` descending (most recent first)
- [ ] AC2: Each log entry displays: project name, branch, duration, event count, summary text, and a relative timestamp (e.g. "2h ago")
- [ ] AC3: Clicking a log entry expands it to show files changed, commit messages, and tool breakdown with icons
- [ ] AC4: Tool breakdown displays tool names with icons (Read -> book icon, Write -> pencil icon, Edit -> wrench icon, Bash -> terminal icon) and counts
- [ ] AC5: Files list is collapsible and shows full file paths from the `files_changed` JSON array
- [ ] AC6: An optional `projectFilter` prop filters logs to a single project when provided
- [ ] AC7: Empty state shows a message when no dev logs exist ("No session logs yet - complete a Claude Code session to see summaries here")
- [ ] AC8: Component uses CSS variables from the theme system (e.g. `var(--theme-bg-primary)`, `var(--theme-text-secondary)`) for dark/light theme support

## Technical Notes

### Architecture
- This is a new Vue 3 SFC using `<script setup lang="ts">` and Composition API
- The component receives `devLogs` as a prop (array of `DevLog` objects) -- data fetching happens in the parent (`App.vue`) via `useProjects` composable (E1-S3)
- Follow the same pattern as `ProjectOverview.vue` which also receives data via props

### Data Shape
The `DevLog` interface (from `apps/server/src/types.ts` lines 84-97):
```typescript
interface DevLog {
  id?: number;
  session_id: string;
  project_name: string;
  branch: string;
  summary: string;
  files_changed: string;     // JSON array of file path strings
  commits: string;           // JSON array of commit message strings
  started_at: number;        // Unix timestamp ms
  ended_at: number;          // Unix timestamp ms
  duration_minutes: number;
  event_count: number;
  tool_breakdown: string;    // JSON object {"Read": 5, "Write": 12, "Edit": 3, "Bash": 8}
}
```

All JSON string fields (`files_changed`, `commits`, `tool_breakdown`) need to be parsed with `JSON.parse()` in helper functions with try/catch fallbacks.

### Helper Functions to Implement
- `toggleExpand(logId: number)` - toggles expanded state for a log entry (use a `Set<number>` ref)
- `parsedFiles(log: DevLog): string[]` - `JSON.parse(log.files_changed || '[]')` with try/catch returning `[]`
- `parsedCommits(log: DevLog): string[]` - `JSON.parse(log.commits || '[]')` with try/catch returning `[]`
- `parsedToolBreakdown(log: DevLog): Record<string, number>` - `JSON.parse(log.tool_breakdown || '{}')` with try/catch returning `{}`
- `toolIcon(toolName: string): string` - maps tool names to emoji: Read -> "book", Write -> "pencil", Edit -> "wrench", Bash -> "terminal", default -> "gear"
- `formatDate(timestamp: number): string` - relative time display (same pattern as `timeAgo()` in ProjectOverview.vue lines 159-167)
- `formatDuration(minutes: number): string` - e.g. "45m" or "1h 23m"

### Styling Patterns
Follow the card pattern from `ProjectOverview.vue`:
- Card container: `bg-[var(--theme-bg-primary)] rounded-xl border border-[var(--theme-border-primary)] shadow-sm`
- Section headers: `text-[var(--theme-text-tertiary)]` with `text-xs font-medium uppercase tracking-wide`
- Mono text for file paths/session IDs: `font-mono text-xs`
- Status badges: use `bg-[var(--theme-bg-tertiary)]` with rounded pill shape

## Tasks
- [ ] Task 1: Create `apps/client/src/components/DevLogTimeline.vue` with template, script setup, and props definition accepting `devLogs: DevLog[]` and optional `projectFilter?: string`
- [ ] Task 2: Implement the collapsed log entry card showing project name, branch badge, summary, duration, event count, and relative timestamp
- [ ] Task 3: Implement expand/collapse functionality with `toggleExpand()` using a reactive `Set<number>` to track expanded log IDs
- [ ] Task 4: Implement expanded detail section with three subsections: Tool Breakdown (with icons and counts), Files Changed (collapsible list), and Commits (list of messages)
- [ ] Task 5: Implement all helper functions: `parsedFiles()`, `parsedCommits()`, `parsedToolBreakdown()`, `toolIcon()`, `formatDate()`, `formatDuration()`
- [ ] Task 6: Implement empty state and project filter logic using `computed` to filter `props.devLogs` by `props.projectFilter`
- [ ] Task 7: Apply theme-aware Tailwind styles matching ProjectOverview.vue visual patterns

## Files to Create/Modify
| File | Action | Description |
|------|--------|-------------|
| `apps/client/src/components/DevLogTimeline.vue` | Create | New component - filterable timeline of session dev logs with expandable details |

## Testing
- [ ] Test 1: Component renders empty state when `devLogs` prop is empty array
- [ ] Test 2: Component renders log entries with correct project name, branch, summary, and timestamp
- [ ] Test 3: Clicking a log entry toggles the expanded detail view
- [ ] Test 4: `parsedToolBreakdown()` correctly parses valid JSON and returns `{}` for invalid input
- [ ] Test 5: `parsedFiles()` correctly parses valid JSON and returns `[]` for invalid input
- [ ] Test 6: `projectFilter` prop correctly filters displayed logs to matching project
- [ ] Test 7: `toolIcon()` returns correct emoji string for each known tool name

## Definition of Done
- [ ] Code compiles without errors (`cd apps/client && bun run build`)
- [ ] All acceptance criteria met
- [ ] No TypeScript errors
- [ ] Responsive on mobile and desktop
- [ ] Dark/light theme support works via CSS variables
- [ ] Component follows existing patterns from ProjectOverview.vue
